{% with messages = get_flashed_messages()%}
{% if messages %}
{% for msg in messages %}
<p>{{msg}}</p>
{% endfor %}
{%endif%}
{% endwith %}

<div class="container col-md-8">
  <canvas id="myChart"></canvas>
</div>

<div class="container col-md-3 justify-content-center">
  {{ pagination.info }}
  {{ pagination.links }}
</div>

<a href="{{ url_for('professor') }}"><button class="btn btn-info btn-lg">Create Class</button></a>
<p class="display-4">Classes statistic</p>
<p class="lead">see your class performance</p>
<table class="table table-striped  table-hover table-sm" cellspacing="0" width="100%">
  <thead class="thead-dark lead">
    <!-- Table top rows -->
    <tr>
      <th scope="col">#</th>
      <th scope="col">Class ID</th>
      <th scope="col">Section Name</th>
      <th scope="col">Class Code</th>
      <th scope="col">Category</th>
    </tr>
  </thead>
  <tbody>

    {% for row in data %}
    <tr class="">
      <form action="/analytics/check" method="GET">
        <th scope="row">{{ loop.index + pagination.skip }}</th>
        <th scope="row">{{row.classId}}</th>
        <td>{{row.sectionName}}</td>
        <!-- Get class code into the form  -->
        <!-- The input cannot be disables -->
        <td >{{row.classCode}}<input type="hidden" name="ccode" value={{row.classCode}}></td> 
        <td>
          <div class="form-group">
            <select name="category" id="category" class="form-control" required>
              <option>Instructor</option>
              <option>Teaching-style</option>
              <option>Topic</option>
              <option>Other</option>
            </select>
          </div>
          <button class="btn btn-block btn-dark" type="submit">Check</button>

        </td>
      </form>
    </tr>
    {% endfor %}
  </tbody>
</table>
<div class="container col-md-3 justify-content-center">
  {{ pagination.links }}
</div>

<script>
  var ctx = document.getElementById('myChart').getContext('2d');
  var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
          labels: ['Instructor', 'Teaching-style', 'Topic','Other'],
          datasets: [{
             
              label: 'Feedback count by category',
              data: ['{{ instructor }}', '{{ teaching}}', '{{ topic }}','{{ other }}'],
              backgroundColor: [
                  'rgba(255, 99, 132, 0.2)',
                  'rgba(54, 162, 235, 0.2)',
                  'rgba(255, 206, 86, 0.2)',
                  'rgba(75, 192, 192, 0.2)',
                  'rgba(153, 102, 255, 0.2)',
                  'rgba(255, 159, 64, 0.2)'
              ],
              borderColor: [
                  'rgba(255, 99, 132, 1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)',
                  'rgba(255, 159, 64, 1)'
              ],
              borderWidth: 1
          }]
      },
      options: {
        labels: {
                // This more specific font property overrides the global property
                fontColor: 'black',
                defaultFontSize: 20
            },
            
        events: ['click'],
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
          }
      }
  });
  </script>