
<div class="container col- mx-auto">
  <div lass="row">
    <p class="display-4">Classes statistic</p>
    <div class="container col-">
      {{ pagination.links }}
    </div>
        <div class="btn-toolbar mb-2 mb-md-0">
          <div class="btn-group mr-2">
            <!-- Put create class button -->
            <a href="{{ url_for('professor') }}"><button class="btn btn-info btn-lg">Create Class</button></a>
          </div>
          
        </div>
  </div>
  <div class="row">
    <!-- Put Chart -->
    <div class="col">
      
      <!-- Put chart here -->
      <canvas id="myChart"></canvas>

    </div>

    <!-- Put table -->
    <div class="col">
      <!-- Filter table -->
      <input class="form-control form-control-dark w-100" 
             type="text" 
             placeholder="Search for a class code" 
             aria-label="Search"
             id="searchInput"
             onkeyup="searchTable()">
      <!-- Put table -->
      <div class="table-responsive">
        <table id="classTable" class="table table-striped  table-hover table-sm" cellspacing="0" width="100%">
          <thead class="thead-dark lead">
            <!-- Table top rows -->
            <tr>
              <th scope="col">#</th>
              <th scope="col">Class ID</th>
              <th scope="col">Class Code</th>
              <th scope="col">Category</th>
              <th scope="col">Options</th>
            </tr>
          </thead>
          <tbody>
        
            {% for row in data %}
            <tr>
              <form action="/analytics/check" method="GET">
                <th scope="row">{{ loop.index + pagination.skip }}</th>
                <th scope="row">{{row.classId}}</th>
                <!-- Get class code into the form  -->
                <!-- The input cannot be disables -->
                <td >{{row.classCode}}<input type="hidden" name="ccode" value={{row.classCode}}></td> 
                <td>
                  <div class="form-group">
                    <select name="category" id="category" class="form-control" required>
                      <option>Instructor</option>
                      <option>Teaching-style</option>
                      <option>Topic</option>
                      <option>Other</option>
                    </select>
                  </div>
                  <button href="{{ url_for('login', page=request.args.get('page')) }}" class="btn btn-block btn-dark" type="submit">Check</button>
                </td>
                <td>
                  <table style="border: none;">
                    <td style="border: none;">
                      <div class="form-group">
                        <a href="/professor/edit/{{row.entryId}}" class="btn btn-outline-success">Edit</a>
                      </div>
                    </td>
                    <td style="border: none;">
                      <a href="/professor/delete/{{row.entryId}}" class="btn btn-outline-danger">Delete</a>
                    </td>
                  </table>
                </td>
              </form>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        
      </div>
    </div>
  </div>
</div>
  

<!-- Draw bar chart -->
<script>
  let ctx = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Instructor', 'Teaching-style', 'Topic','Other'],
        datasets: [{
           
            label: 'Feedback count by category',
            data: ['{{ instructor }}', '{{ teaching}}', '{{ topic }}','{{ other }}'],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
      labels: {
              // This more specific font property overrides the global property
              fontColor: 'black',
              defaultFontSize: 20
          },
          
      events: ['click'],
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});
</script>

<!-- Filter table -->
<script>
function searchTable() {
  // Declare variables
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("searchInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("classTable");
  tr = table.getElementsByTagName("tr");

  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1];
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
}
</script>